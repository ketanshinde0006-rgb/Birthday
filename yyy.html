<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>For You ‚ù§Ô∏è</title>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=Montserrat:wght@300;500&display=swap" rel="stylesheet">
    
    <style>
        /* ============================
           1. CORE THEME
           ============================ */
        :root {
            --neon-pink: #ff00ff;
            --neon-blue: #00ffff;
            --neon-gold: #ffd700;
            --dark-bg: #050510;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            background-color: var(--dark-bg);
            background: radial-gradient(circle at center, #1a1a2e 0%, #000000 100%);
            font-family: 'Montserrat', sans-serif; color: white;
            overflow-x: hidden; min-height: 100vh;
        }

        /* ============================
           2. ANIMATIONS & PARTICLES
           ============================ */
        .hearts-container { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 1; }
        .heart { position: absolute; bottom: -10vh; font-size: 25px; opacity: 0.8; animation: floatUp linear forwards; text-shadow: 0 0 10px rgba(255,255,255,0.5); }
        @keyframes floatUp { 0% { transform: translateY(0) scale(1); opacity: 1; } 100% { transform: translateY(-110vh) scale(0.5); opacity: 0; } }

        /* ============================
           3. UI SCREENS
           ============================ */
        #enter-screen, #loader { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 9999; display: flex; flex-direction: column; justify-content: center; align-items: center; }
        #loader { display: none; }
        .heartbeat { font-size: 6rem; filter: drop-shadow(0 0 20px var(--neon-pink)); animation: beat 1s infinite; }
        @keyframes beat { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.2); } }

        /* ============================
           4. CAKE SEQUENCE (RESTORED)
           ============================ */
        #cake-section { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: rgba(0,0,0,0.98); 
            z-index: 5000; /* MAX Z-INDEX TO ENSURE VISIBILITY */
            display: none; 
            justify-content: center; align-items: center; flex-direction: column; 
            opacity: 0; transition: opacity 1s; 
        }
        
        .cake-container { position: relative; width: 300px; height: 300px; margin-top: 100px; }
        
        .plate { position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); width: 280px; height: 10px; background: #ddd; border-radius: 10px; box-shadow: 0 0 20px rgba(255,255,255,0.5); }
        
        .layer { position: absolute; left: 50%; transform: translateX(-50%); background: linear-gradient(to right, #ff00cc, #333399); border-radius: 10px; box-shadow: 0 0 15px var(--neon-pink); }
        .layer-bottom { bottom: 10px; width: 250px; height: 80px; z-index: 1; }
        .layer-middle { bottom: 90px; width: 200px; height: 70px; z-index: 2; }
        .layer-top { bottom: 160px; width: 150px; height: 60px; z-index: 3; }
        
        .icing { position: absolute; top: 0; left: 0; width: 100%; height: 20px; background: var(--neon-blue); border-radius: 10px 10px 5px 5px; box-shadow: 0 0 10px var(--neon-blue); }
        
        .candle { position: absolute; bottom: 220px; left: 50%; transform: translateX(-50%); width: 15px; height: 50px; background: repeating-linear-gradient(45deg, var(--neon-gold), var(--neon-gold) 5px, #fff 5px, #fff 10px); z-index: 4; box-shadow: 0 0 10px var(--neon-gold); }
        
        .flame { position: absolute; top: -20px; left: 50%; transform: translateX(-50%); width: 15px; height: 25px; background: orange; border-radius: 50% 50% 20% 20%; filter: blur(1px); animation: flicker 0.5s infinite alternate; box-shadow: 0 0 20px orange; }
        @keyframes flicker { to { transform: translateX(-50%) scale(1.1); opacity: 0.8; } }
        
        #sparkle-canvas { position: absolute; top: -150px; left: 50%; transform: translateX(-50%); width: 300px; height: 300px; pointer-events: none; z-index: 5; }
        
        .cake-text { margin-top: 50px; font-family: 'Dancing Script'; font-size: 3rem; color: var(--neon-gold); text-shadow: 0 0 20px var(--neon-gold); opacity: 0; animation: fadeUp 1s forwards 0.5s; }

        /* ============================
           5. HERO SECTION
           ============================ */
        .hero { height: 100vh; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; position: relative; z-index: 10; transition: opacity 1s; }
        .hero h1 { font-family: 'Dancing Script', cursive; font-size: 5rem; background: linear-gradient(to right, var(--neon-pink), var(--neon-blue)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 15px; filter: drop-shadow(0 0 15px rgba(255, 0, 255, 0.4)); animation: fadeUp 1s forwards 1.5s; opacity: 0; transform: translateY(30px); }
        .hero p { font-size: 1.5rem; color: #ddd; letter-spacing: 2px; margin-bottom: 40px; animation: fadeUp 1s forwards 2s; opacity: 0; transform: translateY(30px); }
        .unlock-btn { padding: 20px 60px; font-size: 1.3rem; font-weight: bold; color: white; background: transparent; border: 2px solid var(--neon-pink); border-radius: 50px; cursor: pointer; box-shadow: 0 0 15px var(--neon-pink); transition: all 0.3s ease; animation: fadeUp 1s forwards 2.5s; opacity: 0; transform: translateY(30px); }
        .unlock-btn:hover { background: var(--neon-pink); box-shadow: 0 0 40px var(--neon-pink); transform: scale(1.1); }
        @keyframes fadeUp { to { opacity: 1; transform: translateY(0); } }

        /* ============================
           6. LETTER SECTION
           ============================ */
        .letter-section { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            display: none; justify-content: center; align-items: center;
            z-index: 2000; /* High Z-index */
            padding: 20px;
            opacity: 0; transition: opacity 1s ease;
        }
        .letter-container { 
            width: 100%; max-width: 600px; padding: 40px;
            background: rgba(20, 20, 40, 0.85); backdrop-filter: blur(15px);
            border-radius: 30px; border: 1px solid var(--neon-pink);
            box-shadow: 0 0 40px rgba(255, 0, 255, 0.15);
            text-align: center; display: flex; flex-direction: column; justify-content: center; align-items: center;
        }
        .typewriter { font-family: 'Playfair Display', serif; font-size: 1.1rem; line-height: 1.6; color: #ffffff; white-space: pre-wrap; margin-bottom: 25px; }
        
        /* --- FIXED BUTTON --- */
        #gallery-btn {
            padding: 12px 30px; font-size: 1rem;
            background: linear-gradient(45deg, var(--neon-blue), var(--neon-pink));
            border: none; border-radius: 30px; color: white; font-weight: bold;
            box-shadow: 0 0 15px var(--neon-blue);
            
            /* Hidden Initially */
            opacity: 0; 
            pointer-events: none; 
            transform: scale(0.9);
            
            transition: all 0.5s ease;
        }
        
        #gallery-btn.visible { 
            opacity: 1; 
            pointer-events: auto; /* Clickable */
            cursor: pointer;
            transform: scale(1);
            animation: pulseBtn 2s infinite; 
        }
        @keyframes pulseBtn { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }

        /* ============================
           7. 3D GALLERY
           ============================ */
        .gallery-section { 
            display: none; opacity: 0; padding: 50px 0; 
            transition: opacity 1.5s ease; position: relative; z-index: 30; 
            width: 100%; min-height: 100vh; overflow: hidden; 
            background: radial-gradient(circle, #1a1a2e, #000);
            display: flex; flex-direction: column; align-items: center;
        }
        
        .slider-container {
            position: relative; width: 100%; height: 450px; perspective: 1000px;
            display: flex; justify-content: center; align-items: center; margin-top: 30px;
        }

        .slide-card {
            position: absolute; width: 280px; height: 400px; background: #fff;
            border-radius: 20px; overflow: hidden; transition: all 0.5s ease-in-out;
            box-shadow: 0 15px 50px rgba(0,0,0,0.5); border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .slide-card img { width: 100%; height: 100%; object-fit: cover; filter: brightness(0.6); transition: 0.5s; }
        
        .slide-card.active { transform: translateX(0) scale(1.15); z-index: 10; box-shadow: 0 0 30px var(--neon-pink); border: 2px solid var(--neon-pink); }
        .slide-card.active img { filter: brightness(1); }
        .slide-card.prev { transform: translateX(-240px) scale(0.85) rotateY(15deg); z-index: 5; opacity: 0.6; }
        .slide-card.next { transform: translateX(240px) scale(0.85) rotateY(-15deg); z-index: 5; opacity: 0.6; }
        .slide-card.hidden { transform: scale(0); opacity: 0; }

        .caption-container {
            margin-top: 40px; width: 90%; max-width: 600px;
            background: rgba(0, 0, 0, 0.7); backdrop-filter: blur(10px);
            border: 1px solid var(--neon-blue); border-radius: 20px;
            padding: 20px; text-align: center;
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.2);
            transform: translateY(20px); opacity: 0; transition: all 0.5s ease; position: relative;
        }
        .caption-container::before { content: ''; position: absolute; top: -2px; left: -2px; right: -2px; bottom: -2px; background: linear-gradient(45deg, var(--neon-blue), transparent, var(--neon-pink)); z-index: -1; border-radius: 22px; opacity: 0.5; }
        .caption-container.visible { opacity: 1; transform: translateY(0); }

        .caption-title { font-family: 'Dancing Script'; font-size: 2.5rem; color: var(--neon-blue); margin-bottom: 5px; text-shadow: 0 0 10px var(--neon-blue); }
        .caption-text { font-family: 'Montserrat'; font-size: 1rem; color: #fff; line-height: 1.5; }

        .nav-btn { position: absolute; top: 50%; transform: translateY(-50%); background: rgba(255, 0, 255, 0.2); border: 1px solid var(--neon-pink); color: white; font-size: 2rem; width: 50px; height: 50px; border-radius: 50%; cursor: pointer; z-index: 20; display: flex; justify-content: center; align-items: center; transition: 0.3s; }
        .nav-btn:hover { background: var(--neon-pink); box-shadow: 0 0 20px var(--neon-pink); }
        .prev-btn { left: 20px; } .next-btn { right: 20px; }
        
        #music-control-btn { position: fixed; bottom: 30px; right: 30px; width: 60px; height: 60px; border-radius: 50%; background: var(--neon-pink); border: none; color: white; font-size: 1.5rem; cursor: pointer; box-shadow: 0 0 20px var(--neon-pink); z-index: 100; transition: transform 0.3s; }
        #confetti-canvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 999; }
    </style>
</head>
<body>

    <audio id="audio-loading"> <source src="loading.mp3" type="audio/mpeg"> </audio>
    <audio id="audio-intro" loop> <source src="intro.mp3" type="audio/mpeg"> </audio>
    <audio id="audio-memory" loop> <source src="memory.mp3" type="audio/mpeg"> </audio>

    <div id="enter-screen" onclick="enterSite()"> <div class="heartbeat">üéÅ</div> <p style="margin-top:20px; color:#00ffff;">Tap to Open</p> </div>
    <div id="loader"> <div class="heartbeat" style="color:#ff00ff;">üíñ</div> <div class="loading-text" style="color:white; margin-top:20px;">LOADING LOVE... <span id="progress">0%</span></div> </div>

    <div class="hearts-container"></div>
    <canvas id="confetti-canvas"></canvas>
    <button id="music-control-btn" onclick="toggleMusic()">üîá</button>

    <section class="hero" id="hero-section">
        <h1>Happy Birthday</h1>
        <p>You are my universe ‚ú®</p>
        <button class="unlock-btn" onclick="startCelebration()">Unlock Surprise üì∏</button>
    </section>

    <section id="cake-section">
        <div class="cake-container">
            <div class="cake">
                <div class="plate"></div> <div class="layer layer-bottom"></div> <div class="layer layer-middle"></div> <div class="layer layer-top"></div>
                <div class="icing"></div> <div class="candle"> <div class="flame"></div> </div>
            </div>
            <canvas id="sparkle-canvas"></canvas>
        </div>
        <h1 class="cake-text">Make a Wish! üïØÔ∏è</h1>
    </section>

    <section class="letter-section" id="letter">
        <div class="letter-container">
            <div class="typewriter" id="message-text"></div>
            <button id="gallery-btn" onclick="goToGallery()">‚ú® See Our Journey ‚ú®</button>
        </div>
    </section>

    <section class="gallery-section" id="gallery">
        <h2 style="text-align: center; font-family: 'Dancing Script'; font-size: 3.5rem; color: #ff00ff; margin-bottom: 20px; text-shadow: 0 0 20px #ff00ff; margin-top: 20px;">Our Memories</h2>
        
        <div class="slider-container" id="slider-track"></div>
        <button class="nav-btn prev-btn" onclick="moveSlide(-1)">‚ùÆ</button>
        <button class="nav-btn next-btn" onclick="moveSlide(1)">‚ùØ</button>

        <div class="caption-container visible" id="caption-box">
            <div class="caption-title" id="caption-title">Title Here</div>
            <div class="caption-text" id="caption-text">Description here</div>
        </div>
    </section>

    <script>
        // --- 1. CONFIGURATION ---
        const MEMORIES = [
            { img: "https://source.unsplash.com/random/600x800/?kiss", title: "First Spark ‚ú®", desc: "The moment I knew you were the one." },
            { img: "https://source.unsplash.com/random/600x800/?couple", title: "Us Against World üåç", desc: "Holding your hand makes me invincible." },
            { img: "https://source.unsplash.com/random/600x800/?smile", title: "That Smile üòç", desc: "My favorite view in the entire galaxy." },
            { img: "https://source.unsplash.com/random/600x800/?date", title: "Crazy Nights ü•Ç", desc: "We are weird together, and I love it." },
            { img: "https://source.unsplash.com/random/600x800/?hug", title: "Safe Haven üè°", desc: "In your arms is where I belong." }
        ];

        const LOVE_LETTER = `My Dearest,

Happy Birthday! üéÇ

I built this universe of memories just for you.
Before you see them, I want you to know something...

You are the most beautiful part of my life.
Every day with you is a gift.

Now, let's look at how far we've come.
I love you. ‚ù§Ô∏è

Yours,
[Your Name]`;

        // --- 2. SETUP ---
        let currentIndex = 0;
        let currentAudio = null;
        let sparklerInterval;
        const loadSound = document.getElementById('audio-loading');
        const introMusic = document.getElementById('audio-intro');
        const memoryMusic = document.getElementById('audio-memory');
        const musicBtn = document.getElementById('music-control-btn');

        // --- 3. STARTUP ---
        function enterSite() {
            document.getElementById('enter-screen').style.display='none';
            document.getElementById('loader').style.display='flex';
            loadSound.volume=0.5; loadSound.play().catch(e=>console.log("Audio block"));
            startLoading();
        }

        function startLoading() {
            let progress=0; const txt=document.getElementById('progress');
            const interval=setInterval(()=>{
                progress+=Math.floor(Math.random()*5)+1; if(progress>100)progress=100; txt.innerText=progress+'%';
                if(progress===100){
                    clearInterval(interval); fadeOut(loadSound);
                    setTimeout(()=>{
                        document.getElementById('loader').style.opacity='0';
                        setTimeout(()=>document.getElementById('loader').remove(),1000);
                        playMusic(introMusic); fireConfetti();
                    },500);
                }
            },40);
        }

        // --- 4. CELEBRATION (Sequence Step 1) ---
        function startCelebration() {
            document.getElementById('hero-section').style.opacity='0';
            setTimeout(()=>{
                document.getElementById('hero-section').style.display='none';
                
                // Show Cake (High Z-Index)
                const cakeSec=document.getElementById('cake-section');
                cakeSec.style.display='flex';
                setTimeout(()=>cakeSec.style.opacity='1',100);
                
                startSparklers();
                
                // Wait 6 seconds, then go to Letter
                setTimeout(()=>{
                    stopSparklers(); 
                    cakeSec.style.opacity='0';
                    setTimeout(()=>{ 
                        cakeSec.style.display='none'; 
                        revealLetter(); 
                    },1000);
                },6000);
            },1000);
        }

        // --- 5. LETTER (Sequence Step 2) ---
        function revealLetter() {
            fadeOut(introMusic, ()=>playMusic(memoryMusic));
            const letterSec = document.getElementById('letter');
            letterSec.style.display = 'flex';
            setTimeout(() => {
                letterSec.style.opacity = '1';
                startTypewriter();
            }, 100);
        }

        // --- 6. GALLERY (Sequence Step 3) ---
        function goToGallery() {
            const letterSec = document.getElementById('letter');
            letterSec.style.opacity = '0';
            setTimeout(() => {
                letterSec.style.display = 'none';
                const gallerySec = document.getElementById('gallery');
                gallerySec.style.display = 'flex'; // Use Flex for column layout
                renderSlider();
                updateCaption(); // Init caption
                setTimeout(() => {
                    gallerySec.style.opacity = '1';
                    fireConfetti();
                }, 100);
            }, 1000);
        }

        // --- 7. TYPEWRITER (Controls Button Visibility) ---
        function startTypewriter() {
            let i = 0; const m = document.getElementById('message-text'); 
            m.innerHTML = "";
            const btn = document.getElementById('gallery-btn');
            
            // HIDE BUTTON FIRST
            btn.classList.remove('visible');

            function t() {
                if(i < LOVE_LETTER.length){
                    m.innerHTML+=LOVE_LETTER.charAt(i)==='\n'?'<br>':LOVE_LETTER.charAt(i); 
                    i++; 
                    setTimeout(t,50);
                } else {
                    // SHOW BUTTON AFTER TYPING
                    setTimeout(() => {
                        btn.classList.add('visible'); 
                    }, 500);
                }
            } 
            t();
        }

        // --- UTILS ---
        function renderSlider() {
            const container = document.getElementById('slider-track'); container.innerHTML = '';
            MEMORIES.forEach((mem, i) => {
                const card = document.createElement('div'); card.classList.add('slide-card');
                if (i === currentIndex) card.classList.add('active');
                else if (i === currentIndex - 1) card.classList.add('prev');
                else if (i === currentIndex + 1) card.classList.add('next');
                else card.classList.add('hidden');
                card.innerHTML = `<img src="${mem.img}">`;
                container.appendChild(card);
            });
        }

        function updateCaption() {
            const box = document.getElementById('caption-box');
            const title = document.getElementById('caption-title');
            const text = document.getElementById('caption-text');
            
            box.style.opacity = '0';
            setTimeout(() => {
                title.innerText = MEMORIES[currentIndex].title;
                text.innerText = MEMORIES[currentIndex].desc;
                box.style.opacity = '1';
            }, 300);
        }

        function moveSlide(d) { 
            const n = currentIndex + d; 
            if(n >= 0 && n < MEMORIES.length) { 
                currentIndex = n; 
                renderSlider();
                updateCaption(); 
            } 
        }

        // Swiping Logic
        let touchStartX = 0; let touchEndX = 0;
        const sliderTrack = document.getElementById('slider-track');
        sliderTrack.addEventListener('touchstart', e => { touchStartX = e.changedTouches[0].screenX; });
        sliderTrack.addEventListener('touchend', e => { touchEndX = e.changedTouches[0].screenX; handleSwipe(); });
        function handleSwipe() {
            if (touchEndX < touchStartX - 50) moveSlide(1);
            if (touchEndX > touchStartX + 50) moveSlide(-1);
        }

        function playMusic(a){currentAudio=a; a.volume=0.6; a.play(); musicBtn.innerText='‚è∏Ô∏è';}
        function toggleMusic(){if(!currentAudio)return; if(currentAudio.paused){currentAudio.play();musicBtn.innerText='‚è∏Ô∏è';fireConfetti();}else{currentAudio.pause();musicBtn.innerText='üéµ';}}
        function fadeOut(a,cb){let fade=setInterval(()=>{if(a.volume>0.1)a.volume-=0.1;else{clearInterval(fade);a.pause();if(cb)cb();}},100);}
        
        const sCanvas=document.getElementById('sparkle-canvas');const sCtx=sCanvas.getContext('2d');sCanvas.width=300;sCanvas.height=300;let sparks=[];
        function startSparklers(){sparklerInterval=setInterval(()=>{for(let i=0;i<5;i++)sparks.push({x:150,y:200,vx:(Math.random()-0.5)*10,vy:(Math.random()-1)*10-2,life:1,color:`rgba(255,${Math.floor(Math.random()*100)+155},0,1)`});updateSparks();},30);}
        function stopSparklers(){clearInterval(sparklerInterval);sCtx.clearRect(0,0,300,300);}
        function updateSparks(){sCtx.clearRect(0,0,300,300);sparks.forEach((p,i)=>{p.x+=p.vx;p.y+=p.vy;p.life-=0.03;p.vy+=0.2;if(p.life<=0)sparks.splice(i,1);sCtx.fillStyle=p.color;sCtx.beginPath();sCtx.arc(p.x,p.y,Math.random()*2+1,0,Math.PI*2);sCtx.fill();});}

        function createHeart(){const c=document.querySelector('.hearts-container');const h=document.createElement('div');h.classList.add('heart');const t=['‚ù§Ô∏è','üíñ','‚ú®','ü¶ã'];h.innerHTML=t[Math.floor(Math.random()*t.length)];const cl=['#ff00ff','#00ffff','#ffd700'];h.style.textShadow=`0 0 10px ${cl[Math.floor(Math.random()*cl.length)]}`;h.style.left=Math.random()*100+'vw';h.style.fontSize=Math.random()*20+20+'px';h.style.animationDuration=Math.random()*3+4+'s';c.appendChild(h);setTimeout(()=>h.remove(),7000);}setInterval(createHeart,300);

        const cCanvas=document.getElementById('confetti-canvas');const ctx=cCanvas.getContext('2d');cCanvas.width=window.innerWidth;cCanvas.height=window.innerHeight;let confetti=[];const cColors=['rgba(255,0,255,0.7)','rgba(0,255,255,0.7)','rgba(255,255,255,0.7)'];
        function fireConfetti(){for(let i=0;i<500;i++)confetti.push({x:cCanvas.width/2,y:cCanvas.height/2,w:Math.random()*5+2,h:Math.random()*5+2,dx:Math.random()*12-6,dy:Math.random()*-15-5,color:cColors[Math.floor(Math.random()*cColors.length)],angle:0});animConfetti();}
        function animConfetti(){ctx.clearRect(0,0,cCanvas.width,cCanvas.height);confetti.forEach((p,i)=>{p.x+=p.dx;p.y+=p.dy;p.dy+=0.1;p.angle+=0.1;ctx.save();ctx.translate(p.x,p.y);ctx.rotate(p.angle);ctx.fillStyle=p.color;ctx.fillRect(-p.w/2,-p.h/2,p.w,p.h);ctx.restore();if(p.y>cCanvas.height)confetti.splice(i,1);});if(confetti.length>0)requestAnimationFrame(animConfetti);}
    </script>
</body>
</html>